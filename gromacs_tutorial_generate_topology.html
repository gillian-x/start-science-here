<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate Topology &mdash; start-science-here 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/sphinx_rtd_theme_ext_color_contrast.css" type="text/css" />
      <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examine Topology" href="gromacs_tutorial_examine_topology.html" />
    <link rel="prev" title="Gromacs Tutorial" href="gromacs_tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> start-science-here
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="linux_tutorial.html">Linux tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="windows_susbsystem_for_linux.html">Windows subsystem for linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_docker.html">Installation instructions for Docker</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="gromacs_tutorial.html">Gromacs Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gromacs_tutorial.html#credit">Credit</a></li>
<li class="toctree-l2"><a class="reference internal" href="gromacs_tutorial.html#some-gromacs-basics">Some Gromacs Basics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="gromacs_tutorial.html#lysozyme-tutorial">Lysozyme Tutorial</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Generate Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_examine_topology.html">Examine Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_solvation.html">Solvation</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_adding_ions.html">Adding Ions</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_energy_minimization.html">Energy Minimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_equilibration.html">Equilibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_equilibration_2.html">Equilibration Phase 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_production.html">Production MD</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_analysis.html">Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_more_analysis.html">More Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="gromacs_tutorial_more_analysis.html#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_tutorial.html">Python Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting_up_python.html">Setting Up Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_tutorial.html">Git Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_project.html">Your first project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="raising_issues.html">Raising Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="propose_changes.html">Propose Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading_files.html">Downloading Files from mybinder</a></li>
<li class="toctree-l1"><a class="reference internal" href="uploading_files.html">Uploading Files to mybinder</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Having Problems?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html#contact">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">start-science-here</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="gromacs_tutorial.html">Gromacs Tutorial</a> &raquo;</li>
      <li>Generate Topology</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/kevinsawade/start-science-here/blob/main/docs/source/gromacs_tutorial_generate_topology.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<blockquote>
<div></div></blockquote>
<div class="section" id="generate-topology">
<span id="gromacs-tutorial-generate-topology-label"></span><h1>Generate Topology<a class="headerlink" href="#generate-topology" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>We must download the protein structure file with which we will be working. For this tutorial, we will utilize hen egg white lysozyme (PDB code 1AKI). Open a Terminal on Binder and create a new directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> gromacs_tutorial
</pre></div>
</div>
<p>Currently the directory is empty, except the <code class="docutils literal notranslate"><span class="pre">plot_xvg.py</span></code> script, that will help us plot our results. Have a look at it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ls
$ python3 plot_xvg.py --help:
</pre></div>
</div>
<p>Download the 1AKI.pdb file from the <a class="reference external" href="http://www.rcsb.org/pdb/home/home.do">RCSB</a> via:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ wget https://files.rcsb.org/view/1AKI.pdb -O 1aki.pdb
</pre></div>
</div>
<p>Have a look at the file with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ less 1AKI.pdb
</pre></div>
</div>
<p>Once you have downloaded the structure, you can visualize the structure using a viewing program such as VMD, Chimera, PyMOL, etc. As we are limited by binder, we will use NGLView to visualize the structure in a jupyter-notebook. For that select New and then Python 3 in binder. Paste this code into the notebook and press <span class="boldcode">[Shift]</span> + <span class="boldcode">[Enter]</span> to run the code. Alternatively, you can click the <em>run</em> button.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">ngl</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">ngl</span><span class="o">.</span><span class="n">show_file</span><span class="p">(</span><span class="s1">&#39;gromacs_tutorial/1AKI.pdb&#39;</span><span class="p">,</span> <span class="n">gui</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">clear_representations</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">()</span>
<span class="n">view</span>
</pre></div>
</div>
<a class="reference external image-reference" href="_static/pics/gromacs_tutorial/lysozyme_nglview.png"><img alt="Ball and Stick and Cartoon representation of the Lysozyme protein." src="_images/lysozyme_nglview.png" /></a>
<p>Once you‚Äôve had a look at the molecule, you are going to want to strip out the crystal waters. To delete the water molecules (residue ‚ÄúHOH‚Äù in the PDB file), either use a plain text editor like vi, emacs (Linux/Mac), or Notepad (Windows). Do not use word processing software! Alternatively, you can use grep to delete these lines very easily:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ grep -v HOH 1aki.pdb &gt; 1AKI_clean.pdb
</pre></div>
</div>
<p>Note that such a procedure is <strong>not universally appropriate</strong> (e.g., the case of a tightly bound or otherwise functional active-site water molecule). For our intentions here, we do not need crystal water.</p>
<p>Always check your .pdb file for entries listed under the comment MISSING, as these entries indicate either atoms or whole residues that are not present in the crystal structure. Terminal regions may be absent, and may not present a problem for dynamics. Incomplete internal sequences or any amino acid residues that have missing atoms will cause pdb2gmx to fail. These missing atoms/residues must be modeled in using other software packages. Also note that pdb2gmx is not magic. It cannot generate topologies for arbitrary molecules, just the residues defined by the force field (in the <em>.rtp files - generally proteins, nucleic acids, and a **very*</em> finite amount of cofactors, like NAD(H) and ATP).</p>
<p>Now that the crystal waters are gone and we have verified that all the necessary atoms are present, the PDB file should contain only protein atoms, and is ready to be input into the first GROMACS module, pdb2gmx. The purpose of pdb2gmx is to generate three files:</p>
<ol class="arabic simple">
<li><p>The topology for the molecule.</p></li>
<li><p>A position restraint file.</p></li>
<li><p>A post-processed structure file.</p></li>
</ol>
<p>The topology (topol.top by default) contains all the information necessary to define the molecule within a simulation. This information includes nonbonded parameters (atom types and charges) as well as bonded parameters (bonds, angles, and dihedrals). We will take a more detailed look at the topology once it has been generated.</p>
<p>Execute pdb2gmx by issuing the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ gmx pdb2gmx -f 1AKI_clean.pdb -o 1AKI_processed.gro -water spce
</pre></div>
</div>
<p>The structure will be processed by pdb2gmx, and you will be prompted to choose a force field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">the</span> <span class="n">Force</span> <span class="n">Field</span><span class="p">:</span>
 <span class="n">From</span> <span class="s1">&#39;/usr/local/gromacs/share/gromacs/top&#39;</span><span class="p">:</span>
  <span class="mi">1</span><span class="p">:</span> <span class="n">AMBER03</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Duan</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span> <span class="n">Comp</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1999</span><span class="o">-</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2003</span><span class="p">)</span>
  <span class="mi">2</span><span class="p">:</span> <span class="n">AMBER94</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Cornell</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">JACS</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">5179</span><span class="o">-</span><span class="mi">5197</span><span class="p">,</span> <span class="mi">1995</span><span class="p">)</span>
  <span class="mi">3</span><span class="p">:</span> <span class="n">AMBER96</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Kollman</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Acc</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="n">Res</span><span class="o">.</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">461</span><span class="o">-</span><span class="mi">469</span><span class="p">,</span> <span class="mi">1996</span><span class="p">)</span>
  <span class="mi">4</span><span class="p">:</span> <span class="n">AMBER99</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Wang</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span> <span class="n">Comp</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1049</span><span class="o">-</span><span class="mi">1074</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
  <span class="mi">5</span><span class="p">:</span> <span class="n">AMBER99SB</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Hornak</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Proteins</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">712</span><span class="o">-</span><span class="mi">725</span><span class="p">,</span> <span class="mi">2006</span><span class="p">)</span>
  <span class="mi">6</span><span class="p">:</span> <span class="n">AMBER99SB</span><span class="o">-</span><span class="n">ILDN</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Lindorff</span><span class="o">-</span><span class="n">Larsen</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Proteins</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">1950</span><span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>
  <span class="mi">7</span><span class="p">:</span> <span class="n">AMBERGS</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Garcia</span> <span class="o">&amp;</span> <span class="n">Sanbonmatsu</span><span class="p">,</span> <span class="n">PNAS</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">2782</span><span class="o">-</span><span class="mi">2787</span><span class="p">,</span> <span class="mi">2002</span><span class="p">)</span>
  <span class="mi">8</span><span class="p">:</span> <span class="n">CHARMM27</span> <span class="nb">all</span><span class="o">-</span><span class="n">atom</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">CHARM22</span> <span class="n">plus</span> <span class="n">CMAP</span> <span class="k">for</span> <span class="n">proteins</span><span class="p">)</span>
  <span class="mi">9</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">43</span><span class="n">a1</span> <span class="n">force</span> <span class="n">field</span>
 <span class="mi">10</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">43</span><span class="n">a2</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">improved</span> <span class="n">alkane</span> <span class="n">dihedrals</span><span class="p">)</span>
 <span class="mi">11</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">45</span><span class="n">a3</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Schuler</span> <span class="n">JCC</span> <span class="mi">2001</span> <span class="mi">22</span> <span class="mi">1205</span><span class="p">)</span>
 <span class="mi">12</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">53</span><span class="n">a5</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">JCC</span> <span class="mi">2004</span> <span class="n">vol</span> <span class="mi">25</span> <span class="n">pag</span> <span class="mi">1656</span><span class="p">)</span>
 <span class="mi">13</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">53</span><span class="n">a6</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">JCC</span> <span class="mi">2004</span> <span class="n">vol</span> <span class="mi">25</span> <span class="n">pag</span> <span class="mi">1656</span><span class="p">)</span>
 <span class="mi">14</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">54</span><span class="n">a7</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Eur</span><span class="o">.</span> <span class="n">Biophys</span><span class="o">.</span> <span class="n">J</span><span class="o">.</span> <span class="p">(</span><span class="mi">2011</span><span class="p">),</span> <span class="mi">40</span><span class="p">,,</span> <span class="mi">843</span><span class="o">-</span><span class="mi">856</span><span class="p">,</span> <span class="n">DOI</span><span class="p">:</span> <span class="mf">10.1007</span><span class="o">/</span><span class="n">s00249</span><span class="o">-</span><span class="mi">011</span><span class="o">-</span><span class="mi">0700</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
 <span class="mi">15</span><span class="p">:</span> <span class="n">OPLS</span><span class="o">-</span><span class="n">AA</span><span class="o">/</span><span class="n">L</span> <span class="nb">all</span><span class="o">-</span><span class="n">atom</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="mi">2001</span> <span class="n">aminoacid</span> <span class="n">dihedrals</span><span class="p">)</span>
</pre></div>
</div>
<p>The force field will contain the information that will be written to the topology. This is a very important choice! You should always read thoroughly about each force field and decide which is most applicable to your situation. For this tutorial, we will use the all-atom OPLS force field, so type 15 at the command prompt, followed by ‚ÄòEnter‚Äô.</p>
<p>There are many other options that can be passed to pdb2gmx. Some commonly used ones are listed here:</p>
<ul class="simple">
<li><p>-ignh: Ignore H atoms in the PDB file; especially useful for NMR structures. Otherwise, if H atoms are present, they must be in the named exactly how the force fields in GROMACS expect them to be. Different conventions exist, so dealing with H atoms can occasionally be a headache! If you need to preserve the initial H coordinates, but renaming is required, then the Linux sed command is your friend.</p></li>
<li><p>-ter: Interactively assign charge states for N- and C-termini.</p></li>
<li><p>-inter: Interactively assign charge states for Glu, Asp, Lys, Arg, and His; choose which Cys are involved in disulfide bonds.</p></li>
</ul>
<p>You have now generated three new files: 1AKI_processed.gro, topol.top, and posre.itp. 1AKI_processed.gro is a GROMACS-formatted structure file that contains all the atoms defined within the force field (i.e., H atoms have been added to the amino acids in the protein). The topol.top file is the system topology (more on this in a minute). The posre.itp file contains information used to restrain the positions of heavy atoms (more on this later).</p>
<p>One final note: many users assume that a .gro file is mandatory. <strong>This is not true</strong>. GROMACS can handle many different file formats, with .gro simply being the default for commands that write coordinate files. It is a very compact format, but it has limited precision. If you prefer to use, for instance, PDB format, all you need to do is to specify an appropriate file name with .pdb extension as your output. The purpose of pdb2gmx is to produce a force field-compliant topology; the output structure is largely a side effect of this purpose and is intended for user convenience. The format can be just about anything you like (see the GROMACS manual for different formats).</p>
<p>Next step: <a class="reference internal" href="gromacs_tutorial_examine_topology.html#gromacs-tutorial-examine-topology-label"><span class="std std-ref">Examine Topology</span></a></p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gromacs_tutorial.html" class="btn btn-neutral float-left" title="Gromacs Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gromacs_tutorial_examine_topology.html" class="btn btn-neutral float-right" title="Examine Topology" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kevin Sawade.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>